---
layout: post
title: 1장. 개요
category: ubuntu1804
---

# 홈 서버를 운영하게 된 계기

홈 서버를 운영하는 것이 로망이었다. 요즘엔 클라우딩 서비스가 잘 되어있고 무료로 제공되는 용량도 적당하기 때문에 매달 전기세를 내면서 홈 서버를 운용할 필요성이 적어졌다. 하지만 클라우딩 서비스는 저장을 목적으로 하기 때문에 제한된 점들이 분명히 있다. 또한 개인적인 데이터를 제3자의 저장소에 저장한다는 것 자체가 꺼려진다.

홈 서버를 운용하면 다양한 일들을 할 수 있다. 직접 클라우딩 서비스를 운용하는 것은 물론이고, 토렌트 다운로드, 미디어 스트리밍, 사진 동기화, 웹 호스팅 등 컴퓨터로 할 수 있는 모든 일이  사용성에 알맞게 커스터마이징 할 수 있다. 

홈 서버라고 해서 단순히 서비스를 제공하는 것 뿐만 아니라 문서작업, 웹 서핑, 게임 등 개인적인 용도로도 사용할 수 있다. 보통 3D툴이나 유명한 게임같은 경우 윈도우 기반으로 동작하기 때문에 물론 메인PC에는 윈도우를 설치하여 쓰고 있다. 홈 서버용 PC에는 리눅스를 설치하여 서비스를 제공하고 필요에 따라 서브PC로 사용하는 것을 목적으로 한다.

# 하드웨어 선택

|CPU|i3-4010U, 1.7GHz@2, 15W|
|Memory| 4GB DDR3L x 2|
|Storage 1|128GB M.2|
|Storage 2|3TB HDD using USB port|
|Display| 27", 1920 x 1080, 60Hz|

보통 홈 서버용 PC는 싸고 전력 소모가 적고 안정성있는 제품을 고르면 된다. 하지만 나는 서브PC로 사용할 목적도 있기 때문에 적당한 게임도 돌아갈 정도의 성능을 가진 PC로 구성했다. 나는 홈 서버를 2014년도부터 운용하기 시작했고 당시 파코즈에서 [NUCBOX라는 초미니 PC](http://www.parkoz.com/zboard/view.php?id=notices&no=1196)의 공구를 열어 구매했었다.

>NUCBOX 34010 사양
>
>|모델명|CPU|벤치마크 점수| 클럭 및 TDP| 구매가격|
>|D34010WYKH | i3-4010U | 2514 | 1.7GHz@2 15W|399,000원|

> 구매 후 CPU불량으로 인해 반품요청을 했으나 냉각 팬이 포함된 업그레이드 버전으로 교환해주어서 무소음으로 잘 쓰고 있다 :)

여기에 128GB M2 디스크와 4GB 메모리 2장도 따로 구매했다.

이 외에 모니터, 키보드, 마우스가 필요하다.(6장에서 소개하게 될 Synergy를 설치하면 메인PC의 키보드와 마우스를 홈 서버PC에서 동시에 사용 가능 하므로 실제론 키보드, 마우스도 필요없다.)

## 전기요금

서버는 24시간 가동할 것이다. 몇 달동안 사용해보고 전혀 사용하지 않는 시간대가 있다면 시스템을 꺼놓는 것도 고려해보겠지만 아래 측정한 결과를 보면 시스템을 끄고 키는 수고가 번거롭게 느껴질 것이다.

> 측정은 전기요금측정기를 통해 측정하였다.


|상태|소비전력|하루 예상 사용량|
|모니터 OFF + idle|9W|16Hr|
|모니터 OFF + 동영상 스트리밍|13W|2Hr|
|모니터 ON + idle|9W|2Hr|
|모니터 ON + 동영상 시청 + 웹 서핑|25W|4Hr|

위 표를 토대로 계산하면 월간 8.640kWh를 사용한다. 가정에서 쓰는 전기 요금이 4만원이라고 가정한다면, 대략 1,700원 정도의 비용이 발생한다. 매 달 클라우딩 서비스를 유료로 사용하는 금액 정도를 지불하면서 훨씬 많은 작업들을 할 수 있는 셈이다.

# OS 선택 : Ubuntu Server LTS 18.04
홈 서버를 구축하고 운용하는데 있어서 OS선택은 꽤 중요하다고 생각한다. 윈도우는 기본적으로 컴퓨터를 잘 다루지 못하는 사용자들도 친숙하게 시작할 수 있겠지만 근본적으로 Windows7 or 10은 서버용 OS로 적합하지 않다. 서버용으로 나온 WHS(Windows Home Server) 또한 유료 OS이고 현재는 거의 버려진 상태이기 때문에 굳이 윈도우를 선택할 이유가 없다. 반면에 리눅스는 무료OS이며 오래전부터 많은 사람들이 리눅스를 서버로 사용해왔다. 대부분의 유명 툴들도 리눅스 기반으로 시작되었으며 그만큼 자료도 풍부하다.

리눅스 중에서도 홈 서버를 운용하기 위한 OS를 고르는 기준은 단순하게 정했다. **우분투**는 대중적이며 서버용으로 적합한 OS이다. 매년 4월과 10월에 새 버전을 배포하는데, 4월에 배포하는 버전은 LTS(Long Term Support)버전이다. 2년 마다 새로운 LTS버전이 배포되고 배포된 LTS버전은 5년 동안 지원된다. 새 버전이 배포 될 때 크게 2가지 에디션으로 나뉜다. Ubuntu Desktop은 일반 사용자를 위해 디자인되었기 때문에 그래픽-모드로 설치되고 문서작업 툴, 브라우저, 미디어플레이어 등 기본 프로그램들이 설치된다. 반면에 Ubuntu Server는 네트워크과 서비스를 위한 버전으로 텍스트-모드로 설치되고 간단한 파일 서버만 할 수 있는 상태로 설치된다.

Server 에디션으로 설치했다고 해도 그래픽-모드를 사용 못하는 건 아니다. 그래픽-모드 또한 하나의 패키지이고 이 패키지를 설치하고 구동시켜주면 그래픽-모드로 넘어갈 수 있다. 그렇게 때문에, 나는 Server 에디션을 설치할 것이고, 5장에서 그래픽-모드로 넘어가는 방법을 다룰 것이다.

# 디스크 분리
디스크는 128GB SSD와 3TB HDD를 두었다. 예상하겠지만, 128GB SSD에는 OS를 설치할 것이고 3TB HDD에는 데이터를 저장할 것이다. 이렇게 디스크를 나눈다면 시스템에 치명적인 오류가 발생하여도 HDD에 있는 데이터는 안전하게 보존할 수 있다. HDD에 저장되는 데이터를 더욱 안전하게 보관하기 위해 데이터 백업 및 복원이 가능한 btrfs로 만들 것이다.

# 서비스
홈 서버 설치할 서비스들이다.

- Samba : 파일을 메인PC에서 접근
- NextCloud : 클라우딩 서비스. 스마트폰과 메인PC의 사진, 음악 등 동기화
- Transmission-daemon : 토렌트 다운로드
- Plex : 미디어를 TV, 스마트폰 등에서 스트리밍
- ~~홈페이지 : 이미 jekyll+github pages로 운영하고 있기 때문에 제외~~
- KVM : 가상머신. windows10을 설치하여 엑티브X 설치가 필요한 은행 및 관공서 같은 사이트를 이용

# 서브PC 목적

웹 서핑, 동영상 시청, 업무

synergy를 이용하여 메인PC의 키보드와 마우스를 홈 서버PC에 공유하면 하나의 키보드와 마우스를 두 대의 PC에서 쓸 수 있다.